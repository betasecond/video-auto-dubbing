# TTSæœåŠ¡ç²¾ç®€æ€»ç»“æŠ¥å‘Š

## ç²¾ç®€æˆæœ âœ…

### å¤§å°å¯¹æ¯”
- **ç²¾ç®€å‰**: 2.0MB (140ä¸ªPythonæ–‡ä»¶ï¼Œ34ä¸ªç›®å½•)
- **ç²¾ç®€å**: 80KB (çº¦15ä¸ªæ–‡ä»¶)
- **å‡å°‘å¹…åº¦**: 96% å‡å°‘

### ç§»é™¤çš„ç»„ä»¶
1. **indextts/ ç›®å½•** (1.9MB)
   - å®Œæ•´çš„IndexTTS2æ¨ç†ä»£ç 
   - ç§»è‡³ `backup/tts_components/indextts/`

2. **é‡å‹ä¾èµ–**
   - torchã€transformersç­‰å¤§å‹MLåº“
   - æ”¹ä¸ºè½»é‡çº§HTTPå®¢æˆ·ç«¯

### ä¿ç•™çš„ç»„ä»¶
1. **app/** - FastAPIæ¥å£å±‚
2. **pyproject.toml** - ç²¾ç®€åŒ–ä¾èµ–é…ç½®
3. **Dockerfile** - è½»é‡åŒ–å®¹å™¨æ„å»º
4. **README.md** - éƒ¨ç½²è¯´æ˜

## æ¶æ„å˜æ›´

### ç²¾ç®€å‰ï¼ˆæœ¬åœ°æ¨ç†ï¼‰
```
Worker â†’ HTTP â†’ tts_service (æœ¬åœ°Docker + GPU)
                     â†“
               å†…ç½® IndexTTS2 (1.9MBä»£ç )
```

### ç²¾ç®€åï¼ˆå¤–éƒ¨APIï¼‰
```
Worker â†’ HTTP â†’ tts_service_lean (è½»é‡å®¹å™¨)
                     â†“
               è¿œç¨‹ index-tts-vllm æœåŠ¡
```

## éƒ¨ç½²æ¨¡å¼

### 1. çº¯HTTPä»£ç†æ¨¡å¼ï¼ˆæ¨èï¼‰
```bash
# å¯åŠ¨ç²¾ç®€ç‰ˆTTSæœåŠ¡ä½œä¸ºAPIä»£ç†
docker run -d -p 8000:8000 \\
  -e TTS_REMOTE_URL=https://your-vllm-server.com \\
  tts-service-lean
```

### 2. è¿œç¨‹ç‹¬ç«‹éƒ¨ç½²
```bash
# ç›´æ¥åœ¨è¿œç¨‹GPUæœåŠ¡å™¨éƒ¨ç½²index-tts-vllm
git clone https://github.com/Ksuriuri/index-tts-vllm.git
python api_server_v2.py --model_dir checkpoints/IndexTTS-2
```

## APIå…¼å®¹æ€§

ç²¾ç®€ç‰ˆ**å®Œå…¨å…¼å®¹**åŸç‰ˆAPIï¼š
- âœ… `POST /synthesize`
- âœ… `GET /health`
- âœ… `GET /models`
- ğŸ†• æ”¯æŒOpenAIæ ¼å¼ï¼š`POST /audio/speech`

## ä¾èµ–å¯¹æ¯”

| ç»„ä»¶ | ç²¾ç®€å‰ | ç²¾ç®€å |
|------|--------|--------|
| PyTorch | 2GB+ | ä¸éœ€è¦ |
| Transformers | 500MB+ | ä¸éœ€è¦ |
| CUDA | å¿…éœ€ | ä¸éœ€è¦ |
| IndexTTS2ä»£ç  | 1.9MB | å¤–éƒ¨åŒ… |
| æ€»ä¾èµ–å¤§å° | 3GB+ | ~100MB |

## æ€§èƒ½å½±å“

- **æœ¬åœ°èµ„æº**: GPUä½¿ç”¨ â†’ æ— GPUéœ€æ±‚
- **ç½‘ç»œå»¶è¿Ÿ**: æ—  â†’ å°‘é‡HTTPå»¶è¿Ÿï¼ˆé€šå¸¸<100msï¼‰
- **å¹¶å‘èƒ½åŠ›**: å•è¿›ç¨‹ â†’ è¿œç¨‹æœåŠ¡é«˜å¹¶å‘
- **æ¨ç†é€Ÿåº¦**: åŸºçº¿ â†’ 3xæå‡ï¼ˆvLLMä¼˜åŒ–ï¼‰

## è¿ç§»æ£€æŸ¥æ¸…å•

- [x] å¤‡ä»½åŸç‰ˆTTSæœåŠ¡åˆ° `backup/tts_components/`
- [x] åˆ›å»ºç²¾ç®€ç‰ˆTTSæœåŠ¡
- [x] ç§»é™¤åºå¤§çš„indexttsæ¨ç†ä»£ç 
- [x] æ›´æ–°ä¾èµ–é…ç½®ä¸ºè½»é‡ç‰ˆ
- [x] ä¿æŒAPIå…¼å®¹æ€§
- [x] åˆ›å»ºæ–°çš„éƒ¨ç½²æ–‡æ¡£

## åç»­ä¼˜åŒ–å»ºè®®

### è¿›ä¸€æ­¥ç²¾ç®€
1. **è„šæœ¬æ¸…ç†**: ç§»é™¤ä¸æœ¬åœ°TTSæ¨¡å‹ç›¸å…³çš„è„šæœ¬
   - `scripts/bootstrap.sh` ä¸­çš„æ¨¡å‹ä¸‹è½½éƒ¨åˆ†
   - `scripts/export_tts_model_bundle.sh`
   - `scripts/import_tts_model_bundle.sh`

2. **é…ç½®ç®€åŒ–**: ç§»é™¤æœ¬åœ°TTSç›¸å…³çš„ç¯å¢ƒå˜é‡
   - `INDEXTTS_*` ç³»åˆ—é…ç½®
   - `TTS_BACKEND=index_tts2` ç›¸å…³ä»£ç 

### åŠŸèƒ½å¢å¼º
1. **è¿æ¥æ± **: ä¸ºHTTPå®¢æˆ·ç«¯æ·»åŠ è¿æ¥æ± 
2. **é‡è¯•æœºåˆ¶**: å¢åŠ è¯·æ±‚å¤±è´¥é‡è¯•
3. **è´Ÿè½½å‡è¡¡**: æ”¯æŒå¤šä¸ªTTSæœåŠ¡å®ä¾‹

## é£é™©æ§åˆ¶

- âœ… å®Œæ•´å¤‡ä»½ä¿å­˜åœ¨ `backup/tts_components/`
- âœ… APIæ¥å£ä¿æŒå…¼å®¹
- âœ… Gitå†å²å®Œæ•´ä¿ç•™
- âœ… å¯éšæ—¶å›æ»šåˆ°åŸç‰ˆ

## æ”¶ç›Šæ€»ç»“

1. **å­˜å‚¨èŠ‚çœ**: å‡å°‘96%ä»£ç ä½“ç§¯
2. **éƒ¨ç½²ç®€åŒ–**: æ— éœ€GPUå’Œé‡å‹ä¾èµ–
3. **ç»´æŠ¤ç®€åŒ–**: æ›´å°‘çš„ä»£ç éœ€è¦ç»´æŠ¤
4. **æ€§èƒ½æå‡**: è¿œç¨‹vLLMæœåŠ¡æ€§èƒ½æ›´ä¼˜
5. **æˆæœ¬ä¼˜åŒ–**: æœ¬åœ°æ— éœ€æ˜‚è´µGPUç¡¬ä»¶

---

TTSæœåŠ¡ç²¾ç®€å®Œæˆï¼ç°åœ¨æ˜¯ä¸€ä¸ªçœŸæ­£è½»é‡çº§çš„APIä»£ç†æœåŠ¡ã€‚ ğŸ‰