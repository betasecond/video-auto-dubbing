# 智谱 AI GLM-4-Flash API Key 配置指南

## 🎯 GLM-4-Flash 简介
GLM-4-Flash 是智谱AI推出的首个免费大语言模型，具有以下特点：
- 🆓 **完全免费** - 无需付费即可使用
- 🌍 **多语言支持** - 支持26种语言的智能翻译
- 📝 **超长上下文** - 128K token上下文窗口
- 🚀 **专业翻译** - 特别优化视频字幕翻译任务

## 📋 获取 API Key 步骤

### 第一步：注册智谱AI账户
1. 访问 [智谱AI开放平台](https://open.bigmodel.cn/)
2. 点击"注册"按钮
3. 使用手机号或邮箱完成注册
4. 完成实名认证（需要身份证信息）

### 第二步：创建 API Key
1. 登录后进入 [API 管理页面](https://open.bigmodel.cn/usercenter/apikeys)
2. 点击"新建 API Key"
3. 输入 Key 名称（例如：视频配音系统）
4. 点击"确认"生成 API Key
5. **⚠️ 重要：立即复制保存 API Key，页面关闭后无法再次查看**

### 第三步：配置到系统
选择以下任一方式配置：

#### 方式1：修改 .env 文件（推荐）
编辑 `.env` 文件，将：
```bash
GLM_API_KEY=your_glm_api_key_here
```
替换为：
```bash
GLM_API_KEY=你的实际API_Key
```

#### 方式2：通过Web界面配置
1. 打开系统设置页面
2. 找到"翻译服务配置 (GLM)"部分
3. 在"GLM API Key"输入框中填入你的API Key
4. 点击"测试连接"验证
5. 点击"保存设置"

## 🔧 配置验证

### 检查配置是否生效
```bash
# 方法1：通过API检查
curl -X POST http://localhost:8080/settings/test-translate \
  -H "Content-Type: application/json" \
  -d '{"glm_api_key": "你的API_Key"}'

# 方法2：查看系统日志
docker-compose logs api | grep -i glm
```

### 预期结果
- ✅ 测试连接成功
- ✅ 系统显示"GLM-4-Flash 连接正常"
- ✅ 可以进行翻译测试

## 📊 免费额度说明

GLM-4-Flash 提供的免费额度：
- 🎁 **新用户赠送**：注册即获得免费tokens
- 📅 **每日刷新**：每天都有一定的免费调用量
- 💰 **完全免费**：无需绑定信用卡

## 🔍 常见问题

### Q1: API Key 无效怎么办？
- 确认复制的API Key完整无误
- 检查是否有多余的空格或换行符
- 重新生成一个新的API Key

### Q2: 测试连接失败？
- 确认网络连接正常
- 检查防火墙设置
- 验证API URL是否正确：`https://open.bigmodel.cn/api/paas/v4/chat/completions`

### Q3: 翻译质量如何？
GLM-4-Flash 专门优化了翻译功能：
- 支持上下文感知翻译
- 保持术语一致性
- 适合长文本翻译

### Q4: 免费额度用完了怎么办？
- 等待每日额度刷新
- 或升级到付费版本获得更多额度

## 🎉 配置完成后的功能

配置成功后，你的系统将支持：
- 🎬 **视频字幕翻译**：自动将识别的中文字幕翻译成其他语言
- 🌐 **多语言支持**：支持英语、日语、韩语等26种语言
- ⚡ **实时翻译**：快速响应的翻译服务
- 🎯 **智能优化**：根据视频内容优化翻译质量

---

**下一步：配置完成后，建议进行完整的视频配音流程测试！**